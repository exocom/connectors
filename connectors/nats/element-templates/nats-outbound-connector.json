{
  "$schema": "https://unpkg.com/@camunda/zeebe-element-templates-json-schema/resources/schema.json",
  "name": "NATS Outbound Connector",
  "id": "io.camunda.connectors.NATS.v1",
  "version": 1,
  "description": "Produce NATS message",
  "category": {
    "id": "connectors",
    "name": "Connectors"
  },
  "appliesTo": [
    "bpmn:Task"
  ],
  "elementType": {
    "value": "bpmn:ServiceTask"
  },
  "groups": [
    {
      "id": "authentication",
      "label": "Authentication"
    },
    {
      "id": "nats",
      "label": "NATS"
    },
    {
      "id": "output",
      "label": "Output mapping"
    },
    {
      "id": "error",
      "label": "Error handling"
    },
    {
      "id": "retries",
      "label": "Retries"
    }
  ],
  "properties": [
    {
      "value" : "io.camunda:connector-nats:1",
      "binding" : {
        "property" : "type",
        "type" : "zeebe:taskDefinition"
      },
      "type" : "Hidden"
    },
    {
      "id": "authentication.type",
      "label": "Authentication type",
      "description": "Select the type of authentication to use for the connection",
      "optional": false,
      "value": "NONE",
      "constraints": {
        "notEmpty": true
      },
      "group": "authentication",
      "binding": {
        "name": "authentication.type",
        "type": "zeebe:property"
      },
      "type": "Dropdown",
      "choices": [
        {
          "name": "None",
          "value": "none"
        },
        {
          "name": "username/password",
          "value": "username_password"
        },
        {
          "name": "token",
          "value": "token"
        },
        {
          "name": "jwt/nkey",
          "value": "jwt"
        }
      ]
    },
    {
      "id": "authentication.username",
      "label": "Username",
      "description": "Provide the username (must have permissions to subscribe to the topic)",
      "optional": true,
      "group": "authentication",
      "type": "String",
      "binding": {
        "name": "authentication.username",
        "type": "zeebe:property"
      },
      "condition": {
        "property": "authentication.type",
        "equals": "username_password"
      }
    },
    {
      "id": "authentication.password",
      "label": "Password",
      "description": "Provide a password for the user",
      "optional": true,
      "group": "authentication",
      "type": "String",
      "binding": {
        "name": "authentication.password",
        "type": "zeebe:property"
      },
      "condition": {
        "property": "authentication.type",
        "equals": "username_password"
      }
    },
    {
      "id": "authentication.token",
      "label": "Token",
      "description": "Provide a token for authentication",
      "optional": true,
      "group": "authentication",
      "type": "String",
      "binding": {
        "name": "authentication.token",
        "type": "zeebe:property"
      },
      "condition": {
        "property": "authentication.type",
        "equals": "token"
      }
    },
    {
      "id": "authentication.jwt",
      "label": "JWT",
      "description": "user JWT for authentication",
      "group": "authentication",
      "type": "String",
      "optional": true,
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.jwt"
      },
      "condition": {
        "property": "authentication.type",
        "equals": "jwt"
      }
    },
    {
      "id": "authentication.nkey",
      "label": "NKey seed",
      "description": "If a seed is provided, the public key, and signature are calculated",
      "group": "authentication",
      "type": "String",
      "optional": true,
      "binding": {
        "type": "zeebe:input",
        "name": "authentication.nkey"
      },
      "condition": {
        "property": "authentication.type",
        "equals": "jwt"
      }
    },
    {
      "label": "Servers",
      "description": "Comma-separated list of NATS servers (e.g., nats://localhost:4222)",
      "group": "nats",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:property",
        "name": "servers"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Subject",
      "description": "NATS subject to subscribe to",
      "group": "nats",
      "type": "String",
      "binding": {
        "type": "zeebe:property",
        "name": "subject"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "id": "message",
      "label": "Message",
      "description": "Message to publish",
      "optional": false,
      "constraints": {
        "notEmpty": true
      },
      "feel": "optional",
      "group": "message",
      "binding": {
        "type": "zeebe:input",
        "name": "message"
      },
      "type": "String"
    },
    {
      "id": "resultVariable",
      "label": "Result variable",
      "description": "Name of variable to store the response in",
      "group": "output",
      "binding": {
        "key": "resultVariable",
        "type": "zeebe:taskHeader"
      },
      "type": "String"
    },
    {
      "id": "resultExpression",
      "label": "Result expression",
      "description": "Expression to map the response into process variables",
      "feel": "required",
      "group": "output",
      "binding": {
        "key": "resultExpression",
        "type": "zeebe:taskHeader"
      },
      "type": "Text"
    },
    {
      "id": "errorExpression",
      "label": "Error expression",
      "description": "Expression to handle errors. Details in the <a href=\"https://docs.camunda.io/docs/components/connectors/use-connectors/\" target=\"_blank\">documentation</a>.",
      "feel": "required",
      "group": "error",
      "binding": {
        "key": "errorExpression",
        "type": "zeebe:taskHeader"
      },
      "type": "Text"
    },
    {
      "id": "retryCount",
      "label": "Retries",
      "description": "Number of retries",
      "value": "3",
      "feel": "optional",
      "group": "retries",
      "binding": {
        "property": "retries",
        "type": "zeebe:taskDefinition"
      },
      "type": "String"
    },
    {
      "id": "retryBackoff",
      "label": "Retry backoff",
      "description": "ISO-8601 duration to wait between retries",
      "value": "PT0S",
      "feel": "optional",
      "group": "retries",
      "binding": {
        "key": "retryBackoff",
        "type": "zeebe:taskHeader"
      },
      "type": "String"
    }
  ],
  "icon": {
    "contents": "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18.609842' viewBox='0 0 18 18.609842' %3E%3Cstyle xml:space='preserve'%3Esvg %7Benable-background:new 0 0 288 288%7D%3C/style%3E%3Cstyle xml:space='preserve'%3E.st3%7Bfill:%23375c93%7D.st4%7Bfill:%238dc63f%7D%3C/style%3E%3Cpath fill='%2334a574' d='M 9.166904 0.34022826 h 8.646933 v 7.0099854 H 9.166904 z'/%3E%3Cpath fill='%2327aae1' d='M 0.5199715 0.34022826 h 8.646933 v 7.0099854 H 0.5199715 z'/%3E%3Cpath class='st4' d='M 9.166904 7.356633 h 8.646933 v 7.0099854 H 9.166904 z'/%3E%3Cpath class='st3' d='M 0.5199715 7.356633 h 8.646933 v 7.0099854 H 0.5199715 z'/%3E%3Cpath class='st4' d='M 7.895863 14.328102 l 4.2303853 3.9158344 v -3.9158344 z'/%3E%3Cpath class='st3' d='M 9.166904 14.328102 l 0.044935804 1.232525 l -1.3544936 -1.264622 z'/%3E%3Cpath fill='%23fff' d='M 12.74893 9.404422 V 3.6012838 h 2.067047 V 11.105563 H 11.68331 L 5.3601995 5.1997147 v 5.912268 H 3.2867332 v -7.510699 h 3.2417974 l 6.2203994 5.8031383 z'/%3E%3C/svg%3E"
  }
}